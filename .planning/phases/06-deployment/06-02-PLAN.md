---
phase: 06-deployment
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .gitignore
  - README.md
autonomous: true

must_haves:
  truths:
    - ".gitignore excludes all runtime/sensitive files (venv, .env, logs, debug, .planning)"
    - "README documents full setup from clone to running service with troubleshooting"
  artifacts:
    - path: ".gitignore"
      provides: "Complete exclusion rules for Python project + Pi deployment"
      contains: "venv/"
    - path: "README.md"
      provides: "Full project documentation with setup guide"
      contains: "install.sh"
  key_links:
    - from: "README.md"
      to: "install.sh"
      via: "setup instructions reference install script"
      pattern: "install\\.sh"
    - from: "README.md"
      to: "deploy.sh"
      via: "deployment instructions reference deploy script"
      pattern: "deploy\\.sh"
    - from: ".gitignore"
      to: ".env"
      via: "excludes secrets from git"
      pattern: "\\.env"
---

<objective>
Update .gitignore with complete exclusions and rewrite README.md with full project documentation including setup guide, deployment instructions, and troubleshooting.

Purpose: Ensure no runtime artifacts leak into git and provide comprehensive documentation for initial Pi provisioning and ongoing deployment.

Output: Updated .gitignore and completely rewritten README.md.
</objective>

<execution_context>
@/Users/jean-pierrekoenig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jean-pierrekoenig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-deployment/06-CONTEXT.md
@.planning/phases/06-deployment/06-RESEARCH.md
@README.md
@.gitignore
@.env.example
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update .gitignore with complete exclusions</name>
  <files>.gitignore</files>
  <action>
Replace the existing .gitignore with a comprehensive version. The current .gitignore is missing several entries required by the CONTEXT.md decisions.

Must include (grouped by category):

**Environment and secrets:**
```
.env
.env.*
!.env.example
```

**Python:**
```
__pycache__/
*.pyc
*.pyo
*.egg-info/
*.egg
venv/
```

**Runtime output:**
```
debug/
*.log
```

**Planning docs:**
```
.planning/
```

**Legacy/unused:**
```
display/
```

**OS files:**
```
.DS_Store
Thumbs.db
```

**IDE:**
```
.vscode/
.idea/
*.swp
*.swo
```

Changes from current .gitignore:
- ADD `venv/` (currently missing — critical for Pi deployment)
- ADD `*.log` (log files from RotatingFileHandler)
- ADD `.planning/` (internal planning docs, not for public repo)
- Keep all existing entries
- Organize with clear section headers using `#` comments

Note: Adding `.planning/` to .gitignore means it won't be tracked in future commits. The existing .planning directory is already committed — this prevents future changes from being tracked. This is appropriate because .planning/ is development tooling, not part of the deployed application.
  </action>
  <verify>`cat .gitignore` shows all required entries. `grep 'venv/' .gitignore` finds venv. `grep '\.planning/' .gitignore` finds .planning. `grep '\*\.log' .gitignore` finds log pattern.</verify>
  <done>.gitignore covers all runtime artifacts, secrets, and development-only directories</done>
</task>

<task type="auto">
  <name>Task 2: Rewrite README.md with full documentation</name>
  <files>README.md</files>
  <action>
Completely rewrite README.md. Keep the existing screen screenshots table and hardware table (they're good). Add deployment-specific sections.

README structure (in this order):

1. **Title and description** — Keep existing intro paragraph. Add brief mention of systemd deployment.

2. **Screens** — Keep the existing 2x2 screenshot table exactly as-is.

3. **Hardware** — Keep the existing hardware table exactly as-is.

4. **How It Works** — Brief explanation of the polling loop:
   - Fetches energy data from SolarEdge monitoring API every 5 minutes
   - Renders 4 screens at 4x resolution (1000x488) using PIL
   - Downsamples to 250x122 with LANCZOS resampling for crisp e-ink text
   - Cycles through screens on the display
   - Sleeps between midnight and 6 AM (no solar production)

5. **Prerequisites** — What you need before starting:
   - Raspberry Pi Zero WH with Raspberry Pi OS and SSH access
   - Python 3.9+
   - SolarEdge monitoring account with API access
   - SolarEdge API key and site ID

6. **Quick Start (Raspberry Pi)** — Using install.sh:
   ```bash
   # Clone the repository
   git clone https://github.com/YOUR_USERNAME/solaredge-offgrid-monitor.git /home/pi/solaredge-monitor
   cd /home/pi/solaredge-monitor

   # Run the install script
   ./install.sh

   # Edit your credentials
   nano .env

   # Start the service
   sudo systemctl start solaredge-monitor
   ```

7. **Configuration** — Reference .env.example, show the table of env vars:
   | Variable | Required | Default | Description |
   Include: SOLAREDGE_API_KEY, SOLAREDGE_SITE_ID, SOLAREDGE_POLL_INTERVAL, SOLAREDGE_SLEEP_START, SOLAREDGE_SLEEP_END, SOLAREDGE_DEBUG, SOLAREDGE_LOG_LEVEL

8. **Development (without hardware)** — Debug mode:
   ```bash
   SOLAREDGE_DEBUG=true python3 main.py
   ```
   Explain PNG output to debug/ folder.

9. **Deployment** — How to update after initial setup:
   ```bash
   ssh pi@raspberrypi
   cd /home/pi/solaredge-monitor
   ./deploy.sh
   ```
   Explain what deploy.sh does (git pull, install deps, restart service).

10. **Useful Commands** — Quick reference:
    ```bash
    # Service status
    sudo systemctl status solaredge-monitor

    # Follow logs
    journalctl -u solaredge-monitor -f

    # Stop/start service
    sudo systemctl stop solaredge-monitor
    sudo systemctl start solaredge-monitor

    # View recent logs
    journalctl -u solaredge-monitor -n 50
    ```

11. **Troubleshooting** — Common issues:
    - "Permission denied" on SPI → Check SPI enabled, user in spi/gpio groups
    - Service won't start → Check .env configured, check `journalctl -u solaredge-monitor -n 20`
    - "start request repeated too quickly" → Service crashing on startup, check logs
    - Blank display → Verify SPI wiring, check service is running

12. **Project Structure** — Keep existing tree but add the new files (install.sh, deploy.sh, solaredge-monitor.service, logging_setup.py, screens/error.py).

13. **License** — MIT (keep existing).

Documentation language: English (per CONTEXT.md decision).
Do NOT include a hardware photo placeholder — skip it (Claude's discretion).
  </action>
  <verify>`cat README.md` shows all 13 sections. `grep 'install.sh' README.md` references install script. `grep 'deploy.sh' README.md` references deploy script. `grep 'systemctl' README.md` shows systemd commands. `grep 'Troubleshooting' README.md` shows troubleshooting section exists.</verify>
  <done>README.md provides complete documentation from project overview through setup, deployment, and troubleshooting</done>
</task>

</tasks>

<verification>
1. `.gitignore` contains venv/, *.log, .planning/, .env, debug/, __pycache__/
2. `README.md` has sections: Screens, Hardware, How It Works, Prerequisites, Quick Start, Configuration, Development, Deployment, Useful Commands, Troubleshooting, Project Structure, License
3. README references install.sh and deploy.sh
4. README shows systemd commands for service management
5. README has configuration table matching .env.example variables
</verification>

<success_criteria>
- .gitignore covers all categories: secrets, Python, runtime, planning, OS, IDE
- README is comprehensive: project description, screenshots, hardware, setup guide, configuration, development, deployment, troubleshooting, project structure
- README references install.sh for initial setup and deploy.sh for updates
- README includes systemd service management commands
</success_criteria>

<output>
After completion, create `.planning/phases/06-deployment/06-02-SUMMARY.md`
</output>
